# CÃ³digo utilizado para crear las tablas en un esquema (que es como una base de datos)

## CREAR TABLAS EN EL ESQUEMA PUBLIC (QUE PODRIAMOS INTERPRETAR COMO UNA DE BD)

------------------------------------------------
-- CARGAR CATALOGO DE ENTIDADES


DROP TABLE IF EXISTS PUBLIC.CATALOGO_ENTIDADES;
CREATE TABLE PUBLIC.CATALOGO_ENTIDADES
	(
	SECTOR INT NOT NULL,
	ENTIDAD VARCHAR(10) NOT NULL,
	NOMBRE_ENTIDAD VARCHAR (100) NOT NULL,	
	GRUPO INT NOT NULL,
	NOMBRE_GRUPO VARCHAR (100) NOT NULL,	
	ORDEN INT,
	PRIMARY KEY (ENTIDAD)
	);
	
SELECT * FROM 	PUBLIC.CATALOGO_ENTIDADES LIMIT 5;

SELECT NOMBRE_ENTIDAD, COUNT(*) FROM PUBLIC.CATALOGO_ENTIDADES GROUP BY 1 ORDER BY  COUNT(*) desc;

------------------------------------------------
-- CARGAR CATALOGO DE CONCEPTOS EN ESTADOS FINANCIEROS

DROP TABLE IF EXISTS PUBLIC.CATALOGO_CONCEPTOS_FINANCIEROS;
CREATE TABLE PUBLIC.CATALOGO_CONCEPTOS_FINANCIEROS (
    SECTOR INT NOT NULL,
	IDTEMA INT NOT NULL,
    IDCONCEPTO INT NOT NULL,
	DESCRIPCION VARCHAR(255) NOT NULL,
	NIVEL INT NOT NULL,
	INDICADOR INT NOT NULL,
    ORDEN INT NOT NULL,
    PRIMARY KEY (IDCONCEPTO)
);


	
SELECT * FROM 	PUBLIC.CATALOGO_CONCEPTOS_FINANCIEROS LIMIT 5;

SELECT IDCONCEPTO, COUNT(*) FROM PUBLIC.CATALOGO_CONCEPTOS_FINANCIEROS GROUP BY 1 ORDER BY COUNT(*) DESC;


------------------------------------------------
-- CARGAR TABLA DE SERIES HISTORISCAS DE ESTADOS FINANCIEROS


-- DROP TABLE IF EXISTS PUBLIC.HISTORICO_ESTADOS_FINANCIEROS;
CREATE TABLE PUBLIC.HISTORICO_ESTADOS_FINANCIEROS (
	SECTOR INT NOT NULL,
	IDCONCEPTO INT NOT NULL,
	ENTIDAD VARCHAR(10) NOT NULL,
	PERIODO INT NOT NULL,
	SALDO INT NOT NULL,
	VALOR FLOAT NULL,
	PRIMARY KEY (SECTOR, IDCONCEPTO, ENTIDAD, PERIODO, SALDO),
	FOREIGN KEY (IDCONCEPTO) REFERENCES PUBLIC.CATALOGO_CONCEPTOS_FINANCIEROS(IDCONCEPTO),
    FOREIGN KEY (ENTIDAD) REFERENCES PUBLIC.CATALOGO_ENTIDADES(ENTIDAD));
	
	
SELECT * FROM 	PUBLIC.HISTORICO_ESTADOS_FINANCIEROS LIMIT 5;

SELECT IDCONCEPTO, COUNT(*) FROM PUBLIC.HISTORICO_ESTADOS_FINANCIEROS GROUP BY 1 ORDER BY COUNT(*) DESC;

------------------------------------------------
-- CARGAR TABLA DE RANGOS PERDIDA ESPERADA

DROP TABLE IF EXISTS PUBLIC.TDC_RANGO_PERDIDA_ESPERADA;
CREATE TABLE PUBLIC.TDC_RANGO_PERDIDA_ESPERADA (
	CVE_INSTITUCION VARCHAR(10) NOT NULL,
	CVE_PERIODO INT NOT NULL,
	RANGO_PERDIDA_ESPERADA INT NOT NULL,
	TOTAL FLOAT NULL,
	PRIMARY KEY (CVE_INSTITUCION, CVE_PERIODO, RANGO_PERDIDA_ESPERADA));

	
SELECT * FROM 	PUBLIC.TDC_RANGO_PERDIDA_ESPERADA LIMIT 5;

SELECT CVE_INSTITUCION, COUNT(*) FROM PUBLIC.TDC_RANGO_PERDIDA_ESPERADA GROUP BY 1 ORDER BY COUNT(*) DESC;


------------------------------------------------
-- CARGAR TABLA DE RANGOS DE PAGOS

DROP TABLE IF EXISTS PUBLIC.TDC_RANGO_PAGOS;
CREATE TABLE PUBLIC.TDC_RANGO_PAGOS (
	CVE_INSTITUCION VARCHAR(10) NOT NULL,
	CVE_PERIODO INT NOT NULL,
	RANGO_PAGO_REALIZADO_VS_NO_INTERESES INT NOT NULL,
	TOTAL FLOAT NULL,
	PRIMARY KEY (CVE_INSTITUCION, CVE_PERIODO, RANGO_PAGO_REALIZADO_VS_NO_INTERESES));

SELECT * FROM 	PUBLIC.TDC_RANGO_PAGOS LIMIT 5;

SELECT CVE_INSTITUCION, COUNT(*) FROM PUBLIC.TDC_RANGO_PAGOS GROUP BY 1 ORDER BY COUNT(*) DESC;



------------------------------------------------
-- CARGAR TABLA DE TOTAL DE TARJETAS

DROP TABLE IF EXISTS PUBLIC.TDC_CANTIDAD_TOTAL;
CREATE TABLE PUBLIC.TDC_CANTIDAD_TOTAL (
	CVE_INSTITUCION VARCHAR(10) NOT NULL,
	CVE_PERIODO INT NOT NULL,
	TOTAL FLOAT NULL,
	PRIMARY KEY (CVE_INSTITUCION, CVE_PERIODO));

SELECT * FROM PUBLIC.TDC_CANTIDAD_TOTAL LIMIT 5;

SELECT CVE_INSTITUCION, COUNT(*) FROM PUBLIC.TDC_CANTIDAD_TOTAL GROUP BY 1 ORDER BY COUNT(*) DESC;